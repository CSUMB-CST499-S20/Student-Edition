<script>

// URL's 
// - dashboard : https://script.google.com/a/csumb.edu/macros/s/AKfycbx1dDgb-QNDG2f11KEnNpY3c8QFQG4VgBsz4-swlzMP/dev?v=dashboard
// - todo list: 

$(document).ready(function(){ 

    google.script.run.withSuccessHandler(loadData).getColumnsFromSheet();
    google.script.run.withSuccessHandler(getEmail).getEmailString();
    
    function getEmail(data) {
       window.email = JSON.parse(data);
    }
    
    // Display courses 
    function loadData(data){
    var count = 0;
       var courses = JSON.parse(data) || [];
       $('.coursesList').empty();
       courses.forEach(function(course){
           if (course[0] === window.email) {
              var newDate = "";
              if (course[4] !== "") {
                 var date = new Date(course[4]);
                 newDate = date.toLocaleString("en-US").split(",")[0]
              }
              $('.coursesList').append("<li>" + "<div class='cors'>" + "<b>" + course[2] + "</b>" + "<br>" + course[1] + "</li>");
              count++;
           } 
       })
       
      
       $(".chart--num.assg").append(count);
   
    
    }
    loadData();
    
    function loadTasks(){
    var countTask;
    countTask = 0;
       var tasks = JSON.parse(localStorage.getItem("tasks")) || [];
       $('.taksList').empty();
       tasks.forEach(function(task){
           $('.taksList').append("<li class='taskDash'>" + task.taskName + "</li>");
           countTask++;
       })
       // $(".chart--num.task").append(countTask);
       console.log(typeof countTask);
       if(countTask > 0){
          $(".chart--num.task").append(countTask);
       }else if (countTask === 0){
         $(".chart--num.task").append(0);
       }
       
    }
    
    loadTasks();
    
    
 
    
    
   // function printEmail(email) {
   //    var username = document.getElementById('username'); 
   //    username.innerHTML = email; 
   // }
    
  //  google.script.run.withSuccessHandler(printEmail).getEmail(); 
    
    function printProfile(profile) { 
      document.getElementById("profileImage").src = profile + "-cc-rg";
      console.log(profile); 
    }
    
    google.script.run.withSuccessHandler(printProfile).getProfilePic(); 
});

</script>


