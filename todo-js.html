<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">

<script>

$(document).ready(function(){
   
    $('.openBtn').on('click',function(){
          $('#myModal').modal({show:true});
          //console.log("clicked button"); 
    });
    
    // Save form 
    $("#save").click(function(){
        var values = {};
        $.each($('#assignment-form').serializeArray(), function(i, field) {
          values[field.name] = field.value;
        });
        
        var assignment = $("#title").val();
        var course = $("#courseName").val();
        var duedate = $("#duedate").val();
        console.log(assignment, course, duedate);
        
        google.script.run.getValuesFromForm(values);
        
        var courses = JSON.parse(localStorage.getItem("courses")) || [];
        var newCourses = {
           "assignment" : assignment, 
           "course": course, 
           "duedate": duedate
        }
        courses.push(newCourses);
        localStorage.setItem("courses", JSON.stringify(courses))
        loadData();
        document.getElementById("assignment-form").reset();
        $('#myModal').modal('hide');
               
    });
    
    google.script.run.withSuccessHandler(loadData).getColumnsFromSheet();
    google.script.run.withSuccessHandler(getEmail).getEmailString();
    
    function getEmail(data) {
       window.email = JSON.parse(data);
    }
    
    // Display courses 
    function loadData(data){
    var courses = JSON.parse(data) || [];
       //var courses = JSON.parse(localStorage.getItem("courses")) || [];
       $('#dynamic-list').empty();
       courses.forEach(function(course){
           if (course[0] === window.email) {
           var newDate = "";
           if (course[4] !== "") {
              var date = new Date(course[4]);
              newDate = date.toLocaleString("en-US").split(",")[0]
           }
          
           $('#dynamic-list').append("<li>" + "<div class='assgn'>" + course[1]  + '<span class="deleteCourse"> <i class="far fa-trash-alt"></i> </span>'+ '<span class="editAssignment"> <i class="far fa-edit"></i> </span>' + "</div>" + "<div class='cor'>" + course[2] + "</div>" + "<div class='date'>" + newDate + "</div>" + "</li>");
           }
       }) 
    }
    loadData();
    
    function removeCourse(){
        $(".deleteCourse").click(function(){
            var tasks = JSON.parse(localStorage.getItem("tasks")) || [];
        
        });
    
    
    }
    
     // ToDoList 
     $("#btn").click(function(){
        var task = $("#newTask").val();
        console.log(task);
        
        var tasks = JSON.parse(localStorage.getItem("tasks")) || [];
        var newTask = {
           "taskName" : task
        }
        tasks.push(newTask);
        localStorage.setItem("tasks", JSON.stringify(tasks))
        loadTasks();    
    });
    
    function loadTasks(){
       var tasks = JSON.parse(localStorage.getItem("tasks")) || [];
       $('#taskUL').empty();
       tasks.forEach(function(task){
           $('#taskUL').append("<li class='task'>" + task.taskName  + '<span class="deleteTask"> <i class="far fa-trash-alt"></i> </span>' + '<span class="editAssignment"> <i class="far fa-edit"></i> </span>' + "</li>");
       })
    
    }
    
    loadTasks();
});
</script>

